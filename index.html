<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>MAD System - Ultimate Templates</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&family=Playfair+Display:wght@400;700&family=Heebo:wght@300;400;700&family=Rubik:wght@400;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    
    <style>
        /* --- Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© --- */
        :root {
            --theme-color: #D4AF37; /* Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ */
            --bg-sidebar: #1a1a1a;
            --bg-workspace: #f4f4f4;
            --font-main: 'Assistant', sans-serif;
            --sidebar-width: 300px;
        }

        @page { size: A4; margin: 0; }
        
        body {
            margin: 0; padding: 0;
            background-color: var(--bg-workspace);
            font-family: var(--font-main);
            display: flex; height: 100vh; overflow: hidden;
        }

        /* --- Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠ (Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…) --- */
        .sidebar {
            width: var(--sidebar-width);
            background: var(--bg-sidebar); color: #fff;
            padding: 20px; overflow-y: auto;
            display: flex; flex-direction: column; gap: 20px;
            box-shadow: -2px 0 10px rgba(0,0,0,0.2);
            z-index: 1000;
        }

        .panel-section {
            background: #252525; padding: 15px; border-radius: 8px; border: 1px solid #333;
        }
        .panel-title {
            font-size: 13px; color: var(--theme-color); font-weight: bold;
            text-transform: uppercase; margin-bottom: 10px; border-bottom: 1px solid #444; padding-bottom: 5px;
        }

        /* Ø¹Ù†Ø§ØµØ± Ø§Ù„ØªØ­ÙƒÙ… */
        .btn-action {
            width: 100%; padding: 12px; border: none; border-radius: 5px;
            cursor: pointer; font-weight: bold; font-family: inherit; margin-bottom: 10px;
            display: flex; align-items: center; justify-content: center; gap: 8px; transition: 0.2s;
        }
        .btn-print { background: var(--theme-color); color: #000; }
        .btn-print:hover { filter: brightness(1.1); }
        
        .btn-upload {
            background: #333; color: #ccc; border: 1px dashed #555;
            font-size: 12px; padding: 8px;
        }
        .btn-upload:hover { border-color: var(--theme-color); color: var(--theme-color); }

        select, input[type="range"] { width: 100%; margin-bottom: 5px; background: #333; color: white; border: 1px solid #444; border-radius: 4px; padding: 5px; }
        input[type="range"] { height: 4px; -webkit-appearance: none; background: #444; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; width: 14px; height: 14px; background: var(--theme-color); border-radius: 50%; cursor: pointer; }

        /* --- Ù…Ù†Ø·Ù‚Ø© Ø§Ù„Ø¹Ù…Ù„ --- */
        .workspace {
            flex-grow: 1; display: flex; justify-content: center; padding: 40px; overflow-y: auto;
        }

        .a4-page {
            width: 210mm; min-height: 296mm;
            background-color: white;
            position: relative;
            box-shadow: 0 0 25px rgba(0,0,0,0.1);
            padding: 20mm; box-sizing: border-box;
            display: flex; flex-direction: column;
        }

        /* --- Ø§Ù„Ø¹Ù†Ø§ØµØ± Ø§Ù„Ø«Ø§Ø¨ØªØ© (Header/Footer) --- */
        .header-section { margin-bottom: 20px; text-align: center; }
        .logo-img { max-width: 100%; display: block; margin: 0 auto; } /* Ø§Ù„ØªØ­ÙƒÙ… Ø¨Ø§Ù„Ø­Ø¬Ù… Ø¹Ø¨Ø± Ø§Ù„Ø­Ø§ÙˆÙŠØ© */
        
        .footer-section {
            margin-top: auto; padding-top: 15px;
            border-top: 1px solid var(--theme-color);
            text-align: center; font-size: 11px; color: #555;
        }

        /* --- Ø§Ù„Ø®ØªÙ… Ø§Ù„Ù…ØªØ­Ø±Ùƒ --- */
        #stamp-wrapper {
            position: absolute; width: 150px; cursor: grab; z-index: 50;
            top: 75%; left: 15%; /* Default */
        }
        #stamp-wrapper img { width: 100%; pointer-events: none; }
        #stamp-wrapper:active { cursor: grabbing; }

        /* --- Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ ÙˆØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ --- */
        .template-content { flex-grow: 1; outline: none; }
        
        table.mad-table { width: 100%; border-collapse: collapse; margin: 20px 0; font-size: 14px; }
        table.mad-table th { background: #f8f8f8; border-bottom: 2px solid var(--theme-color); padding: 10px; text-align: right; font-weight: bold; }
        table.mad-table td { border-bottom: 1px solid #eee; padding: 10px; }
        table.mad-table tr:last-child td { border-bottom: none; }

        .invoice-summary { display: flex; justify-content: flex-end; margin-top: 20px; }
        .invoice-box { background: #f9f9f9; padding: 15px; border-radius: 5px; width: 200px; }
        
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; font-size: 14px; }
        .info-item { border-bottom: 1px solid #eee; padding-bottom: 5px; }

        /* Ø§Ù„Ø¥Ø·Ø§Ø± (ÙŠØ¸Ù‡Ø± ÙÙ‚Ø· ÙÙŠ Ø¨Ø¹Ø¶ Ø§Ù„Ø«ÙŠÙ…Ø§Øª) */
        .border-frame {
            position: absolute; top: 10mm; left: 10mm; right: 10mm; bottom: 10mm;
            border: 2px solid var(--theme-color); pointer-events: none; display: none;
        }
        .show-frame .border-frame { display: block; }

        /* --- Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© --- */
        @media print {
            body { background: white; display: block; }
            .sidebar { display: none; }
            .workspace { padding: 0; margin: 0; }
            .a4-page { box-shadow: none; width: 100%; height: 100%; margin: 0; page-break-after: avoid; }
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <div style="text-align: center; color: white;">
            <h2 style="margin: 0;">MAD System</h2>
            <small style="opacity: 0.6;">Ultimate Template Engine</small>
        </div>
        <hr style="border-color: #333; width: 100%;">

        <button class="btn-action btn-print" onclick="window.print()">
            <i class="fas fa-print"></i> Ø·Ø¨Ø§Ø¹Ø© / PDF
        </button>

        <div class="panel-section">
            <div class="panel-title">1. Ù†ÙˆØ¹ Ø§Ù„Ù…Ø³ØªÙ†Ø¯ (Templates)</div>
            <select id="templateSelect" onchange="loadTemplate(this.value)">
                <option value="letter">ğŸ“„ Ø±Ø³Ø§Ù„Ø© Ø±Ø³Ù…ÙŠØ© (Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ)</option>
                <option value="invoice">ğŸ’° ÙØ§ØªÙˆØ±Ø© / Ø¹Ø±Ø¶ Ø³Ø¹Ø±</option>
                <option value="table">ğŸ“‹ Ø¬Ø¯ÙˆÙ„ Ø¨ÙŠØ§Ù†Ø§Øª / Ø¬Ø±Ø¯</option>
                <option value="legal">âš–ï¸ ØªØ¹Ù‡Ø¯ Ù‚Ø§Ù†ÙˆÙ†ÙŠ / Ø¹Ù‚Ø¯</option>
                <option value="memo">ğŸ“ Ù…Ø°ÙƒØ±Ø© Ø¯Ø§Ø®Ù„ÙŠØ©</option>
                <option value="certificate">ğŸ† Ø´Ù‡Ø§Ø¯Ø© / ØªÙ‚Ø¯ÙŠØ±</option>
                <option value="delivery">ğŸ“¦ Ù†Ù…ÙˆØ°Ø¬ Ø§Ø³ØªÙ„Ø§Ù…</option>
            </select>
        </div>

        <div class="panel-section">
            <div class="panel-title">2. Ø§Ù„ØªØµÙ…ÙŠÙ… (Theme)</div>
            <div style="display: flex; gap: 5px; margin-bottom: 10px;">
                <button onclick="setTheme('#D4AF37', true)" style="flex:1; height:30px; background:#D4AF37; border:none; cursor:pointer;" title="Ø°Ù‡Ø¨ÙŠ"></button>
                <button onclick="setTheme('#000000', false)" style="flex:1; height:30px; background:#000000; border:none; cursor:pointer;" title="Ø£Ø³ÙˆØ¯"></button>
                <button onclick="setTheme('#1a5f7a', false)" style="flex:1; height:30px; background:#1a5f7a; border:none; cursor:pointer;" title="Ø£Ø²Ø±Ù‚ Ø´Ø±ÙƒØ§Øª"></button>
                <button onclick="setTheme('#555555', true)" style="flex:1; height:30px; background:#555555; border:none; cursor:pointer;" title="Ø±Ù…Ø§Ø¯ÙŠ"></button>
            </div>
            <label style="font-size:12px; display:block; margin-bottom:5px;">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ø¥Ø·Ø§Ø±:</label>
            <select onchange="toggleFrame(this.value)">
                <option value="yes">Ù†Ø¹Ù… (Ø¥Ø·Ø§Ø± ÙƒØ§Ù…Ù„)</option>
                <option value="no">Ù„Ø§ (Ø¨Ø¯ÙˆÙ† Ø¥Ø·Ø§Ø±)</option>
            </select>
        </div>

        <div class="panel-section">
            <div class="panel-title">3. Ø§Ù„Ù„ÙˆØ¬Ùˆ ÙˆØ§Ù„Ø®ØªÙ…</div>
            
            <label class="btn-action btn-upload">
                <i class="fas fa-upload"></i> Ø±ÙØ¹ Ø§Ù„Ù„ÙˆØ¬Ùˆ
                <input type="file" hidden onchange="loadImage(this, 'mainLogo')">
            </label>
            <div style="display:flex; justify-content: space-between; font-size:11px; color:#aaa;"><span>Ø­Ø¬Ù… Ø§Ù„Ù„ÙˆØ¬Ùˆ</span></div>
            <input type="range" min="100" max="400" value="200" oninput="resizeEl('logoContainer', this.value, 'width')">

            <label class="btn-action btn-upload" style="margin-top:10px;">
                <i class="fas fa-stamp"></i> Ø±ÙØ¹ Ø§Ù„Ø®ØªÙ…
                <input type="file" hidden onchange="loadImage(this, 'stampImg', true)">
            </label>
            <div style="display:flex; justify-content: space-between; font-size:11px; color:#aaa;"><span>Ø­Ø¬Ù… Ø§Ù„Ø®ØªÙ…</span></div>
            <input type="range" min="50" max="300" value="150" oninput="resizeEl('stamp-wrapper', this.value, 'width')">
            
            <div style="display:flex; justify-content: space-between; font-size:11px; color:#aaa;"><span>Ø´ÙØ§ÙÙŠØ© Ø§Ù„Ø®ØªÙ…</span></div>
            <input type="range" min="0.1" max="1" step="0.1" value="0.9" oninput="resizeEl('stamp-wrapper', this.value, 'opacity')">
        </div>
    </div>

    <div class="workspace">
        <div id="page" class="a4-page show-frame">
            <div class="border-frame"></div>

            <div class="header-section">
                <div id="logoContainer" style="width: 200px; margin: 0 auto;">
                    <img id="mainLogo" src="logo.png" class="logo-img" alt="LOGO" onerror="this.src='https://via.placeholder.com/200x80?text=MAD+PARFUMEUR'">
                </div>
            </div>

            <div id="stamp-wrapper" onmousedown="startDrag(event)">
                <img id="stampImg" src="" alt="" style="display: none;">
            </div>

            <div id="mainContent" class="template-content" contenteditable="true">
                </div>

            <div class="footer-section" contenteditable="true">
                <strong>MAD PARFUMEUR LTD</strong> | 515456093 | www.madperfume.co.il<br>
                ×©×™×¨×•×ª ×œ×§×•×—×•×ª: *9935 | Email: info@madperfume.co.il
            </div>
        </div>
    </div>

    <script>
        // --- 1. Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù‚ÙˆØ§Ù„Ø¨ (Templates DB) ---
        const templates = {
            // Ø§Ù„Ù‚Ø§Ù„Ø¨ 1: Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ© (Ø§Ù„Ù†Øµ Ø§Ù„Ø­Ø§Ù„ÙŠ)
            letter: `
                <div style="display: flex; justify-content: space-between; font-size: 14px; margin-bottom: 30px;">
                    <div><strong>×ª××¨×™×š:</strong> 07 ×™× ×•××¨ 2026</div>
                    <div><strong>×¡×™××•×›×™×Ÿ:</strong> LEG-01/26</div>
                </div>
                <div style="margin-bottom: 20px;">
                    <strong>×œ×›×‘×•×“:</strong><br>×”× ×”×œ×ª ×§× ×™×•×Ÿ ××•×œ ×”×—×•×£ (Village)<br>×—×“×¨×”
                </div>
                <div style="text-align: center; text-decoration: underline; font-weight: bold; font-size: 18px; margin-bottom: 25px;">
                    ×”× ×“×•×Ÿ: ×”×‘×”×¨×” ×•×”×©×œ××ª ×¤×¨×˜×™× - ×‘×§×©×” ×œ×”×¢×‘×¨×ª ×–×›×•×™×•×ª ×‘× ×›×¡
                </div>
                <div style="text-align: justify; line-height: 1.6;">
                    <p><strong>×.×’.× ,</strong></p>
                    <p>×‘×”××©×š ×œ×¤× ×™×™×ª×›×, ×”×¨×™× ×• ×œ×”×©×™×‘×›× ×›×“×œ×§××Ÿ ×‘× ×•×’×¢ ×œ×‘×§×©×” ×œ×”×¢×‘×¨×ª ×”×–×›×•×™×•×ª ×‘×—×•×–×” ×”×©×›×™×¨×•×ª:</p>
                    <p>1. <strong>×¨×¦×™×¤×•×ª ×¢×¡×§×™×ª:</strong> ×”×¢×‘×¨×ª ×”×–×›×•×™×•×ª × ×¢×©×™×ª ××˜×¢××™× ××¨×’×•× ×™×™× ×¤× ×™××™×™× ×œ×”×‘×˜×—×ª ×”××©×š ×”×¤×¢×œ×ª ×”×¢×¡×§ ×‘××•×©×›×¨ ×œ×œ× ×©×™× ×•×™ ×‘××•×¤×™ ×”×¤×¢×™×œ×•×ª.</p>
                    <p>2. <strong>×”×¦×“ ×”× ×›× ×¡:</strong> ×”×’×‘' <strong>×¡×××— ××—×××™×“</strong> ××§×‘×œ×ª ×¢×œ ×¢×¦××” ××ª ××œ×•× ×”×”×ª×—×™×™×‘×•×™×•×ª.</p>
                    <p>3. <strong>×‘×™×˜×—×•× ×•×ª:</strong> × ×›×•× ×•×ª ×œ×”×¢××™×“ ×‘×™×˜×—×•× ×•×ª ×—×œ×•×¤×™×™× ×‘×”×ª×× ×œ×“×¨×™×©×•×ª.</p>
                    <p>× ×•×“×” ×œ××™×©×•×¨×›×.</p>
                </div>
                <div style="margin-top: 40px;">
                    <p>×‘×›×‘×•×“ ×¨×‘,</p><p style="font-weight: bold;">×××“ ×¤×¨×¤×™×•× ×‘×¢"×</p>
                    <div style="border-top: 1px solid #000; width: 200px; margin-top: 40px; padding-top: 5px;">×—×ª×™××” ×•×—×•×ª××ª ×”×—×‘×¨×”</div>
                </div>
            `,

            // Ø§Ù„Ù‚Ø§Ù„Ø¨ 2: ÙØ§ØªÙˆØ±Ø© / Ø¹Ø±Ø¶ Ø³Ø¹Ø±
            invoice: `
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; border-bottom: 2px solid #eee; padding-bottom: 10px;">
                    <h1 style="margin:0; font-size: 24px;">×”×¦×¢×ª ××—×™×¨ / Price Quote</h1>
                    <div style="text-align: left;">××¡×¤×¨: <strong>#2026-1001</strong><br>×ª××¨×™×š: 07/01/2026</div>
                </div>
                <div class="info-grid">
                    <div><strong>×œ×›×‘×•×“:</strong><br>×©× ×”×œ×§×•×—: ________________<br>×—.×¤/×ª.×–: ________________</div>
                    <div><strong>×¤×¨×˜×™ ×ª×©×œ×•×:</strong><br>×ª×•×§×£ ×”×”×¦×¢×”: 14 ×™×•×<br>×ª× ××™ ×ª×©×œ×•×: ×©×•×˜×£ + 30</div>
                </div>
                <table class="mad-table">
                    <thead><tr><th>×ª×™××•×¨ ×¤×¨×™×˜ (Description)</th><th>×›××•×ª (Qty)</th><th>××—×™×¨ ×™×—' (Price)</th><th>×¡×”"×› (Total)</th></tr></thead>
                    <tbody>
                        <tr><td>×‘×•×©× × ×™×©×” - MAD Signature</td><td>10</td><td>â‚ª 250</td><td>â‚ª 2,500</td></tr>
                        <tr><td>××¤×™×¥ ×¨×™×— ×™×•×§×¨×ª×™ (×’×“×•×œ)</td><td>5</td><td>â‚ª 120</td><td>â‚ª 600</td></tr>
                        <tr><td>×××¨×– ×“×•×’××™×•×ª VIP</td><td>20</td><td>â‚ª 0</td><td>â‚ª 0</td></tr>
                    </tbody>
                </table>
                <div class="invoice-summary">
                    <div class="invoice-box">
                        <div style="display:flex; justify-content:space-between;"><span>×¡×”"×› ×œ×¤× ×™ ××¢"×:</span><strong>â‚ª 3,100</strong></div>
                        <div style="display:flex; justify-content:space-between;"><span>××¢"× (17%):</span><strong>â‚ª 527</strong></div>
                        <div style="border-top:1px solid #ccc; margin-top:5px; padding-top:5px; display:flex; justify-content:space-between; font-size:16px;"><span>×¡×”"×› ×œ×ª×©×œ×•×:</span><strong>â‚ª 3,627</strong></div>
                    </div>
                </div>
            `,

            // Ø§Ù„Ù‚Ø§Ù„Ø¨ 3: Ø¬Ø¯ÙˆÙ„ Ø¨ÙŠØ§Ù†Ø§Øª
            table: `
                <h2 style="text-align: center; margin-bottom: 20px;">×“×•×— ××œ××™ / ×¨×©×™××ª ×¡× ×™×¤×™×</h2>
                <div style="margin-bottom: 15px;"><strong>×ª××¨×™×š ×¢×“×›×•×Ÿ:</strong> 07/01/2026</div>
                <table class="mad-table">
                    <thead><tr><th>×§×•×“ ×¤×¨×™×˜</th><th>×©× ××•×¦×¨ / ×¡× ×™×£</th><th>×§×˜×’×•×¨×™×”</th><th>×¡×˜×˜×•×¡ / ××œ××™</th><th>×”×¢×¨×•×ª</th></tr></thead>
                    <tbody>
                        <tr><td>MAD-001</td><td>×§× ×™×•×Ÿ ××•×œ ×”×—×•×£ - ×—×“×¨×”</td><td>×¡× ×™×£ ×¨××©×™</td><td>×¤×¢×™×œ</td><td>×—×•×–×” ×‘×ª×•×§×£</td></tr>
                        <tr><td>PRF-102</td><td>Niche Perfume X1</td><td>×‘×©××™×</td><td>54 ×™×—'</td><td>××œ××™ × ××•×š</td></tr>
                        <tr><td>PRF-105</td><td>Gold Edition 100ml</td><td>×‘×©××™×</td><td>120 ×™×—'</td><td>×‘××œ××™</td></tr>
                        <tr><td>ACC-002</td><td>×‘×§×‘×•×§ ×˜×¡×˜×¨</td><td>×¦×™×•×“</td><td>200 ×™×—'</td><td>-</td></tr>
                        <tr><td>-</td><td>-</td><td>-</td><td>-</td><td>-</td></tr>
                    </tbody>
                </table>
            `,

            // Ø§Ù„Ù‚Ø§Ù„Ø¨ 4: ØªØ¹Ù‡Ø¯ Ù‚Ø§Ù†ÙˆÙ†ÙŠ
            legal: `
                <h1 style="text-align: center; font-family: 'Playfair Display'; margin-bottom: 10px;">×›×ª×‘ ×”×ª×—×™×™×‘×•×ª ×•×©×™×¤×•×™</h1>
                <div style="text-align: center; margin-bottom: 40px;">×©× ×¢×¨×š ×•× ×—×ª× ×‘×™×•× 07 ×‘×—×•×“×© ×™× ×•××¨ ×©× ×ª 2026</div>
                <div style="line-height: 2; text-align: justify; padding: 0 20px;">
                    <p>×× ×™ ×”×—×ª×•× ××˜×”, <strong>×××“ ×¤×¨×¤×™×•× ×‘×¢"×</strong> (×—.×¤ 515456093), ××¦×”×™×¨ ×•××ª×—×™×™×‘ ×‘×–××ª ×›×œ×¤×™ <strong>×”× ×”×œ×ª ×”×§× ×™×•×Ÿ</strong> ×›×“×œ×§××Ÿ:</p>
                    <ol>
                        <li>×”× × ×™ ×××©×¨ ×›×™ ×§×¨××ª×™ ××ª ×›×œ ×ª× ××™ ×”×—×•×–×” ×•×”×‘× ×ª×™ ××ª ×ª×•×›× ×.</li>
                        <li>×× ×™ ××ª×—×™×™×‘ ×œ×©××•×¨ ×¢×œ ×”×•×¨××•×ª ×”×‘×˜×™×—×•×ª ×•×”× ×™×”×•×œ ×©×œ ×”× ×›×¡ ×œ×œ× ×™×•×¦× ××Ÿ ×”×›×œ×œ.</li>
                        <li>×™×“×•×¢ ×œ×™ ×›×™ ×›×ª×‘ ×”×ª×—×™×™×‘×•×ª ×–×” ×”×™× ×• ×‘×œ×ª×™ ×—×•×–×¨ ×•××”×•×•×” ×—×œ×§ ×‘×œ×ª×™ × ×¤×¨×“ ××”×¡×›× ×”×©×›×™×¨×•×ª.</li>
                        <li>×‘×›×œ ××§×¨×” ×©×œ ×”×¤×¨×”, ××”×™×” ×¦×¤×•×™ ×œ×¡× ×§×¦×™×•×ª ×”×§×‘×•×¢×•×ª ×‘×—×•×§ ×•×‘×—×•×–×”.</li>
                    </ol>
                    <p style="margin-top: 30px;">×•×œ×¨××™×” ×‘××ª×™ ×¢×œ ×”×—×ª×•×:</p>
                </div>
                <div style="display: flex; justify-content: space-between; margin-top: 50px; padding: 0 50px;">
                    <div style="text-align: center;">________________<br>×—×ª×™××ª ×”××¦×”×™×¨</div>
                    <div style="text-align: center;">________________<br>××™×©×•×¨ ×¢×•"×“</div>
                </div>
            `,

            // Ø§Ù„Ù‚Ø§Ù„Ø¨ 5: Ù…Ø°ÙƒØ±Ø©
            memo: `
                <div style="border: 2px solid #333; padding: 20px; border-radius: 8px; background: #fafafa;">
                    <h2 style="margin-top: 0; border-bottom: 2px solid var(--theme-color); padding-bottom: 10px;">××–×›×¨ ×¤× ×™××™ / MEMO</h2>
                    <div style="display: grid; grid-template-columns: 100px 1fr; gap: 10px; margin-bottom: 20px;">
                        <strong>××œ:</strong> <span>×›×œ ×¢×•×‘×“×™ ×”×¡× ×™×¤×™×</span>
                        <strong>×××ª:</strong> <span>×”× ×”×œ×” ×¨××©×™×ª</span>
                        <strong>×ª××¨×™×š:</strong> <span>07/01/2026</span>
                        <strong>×”× ×“×•×Ÿ:</strong> <span>×¢×“×›×•×Ÿ × ×”×œ×™ ×¤×ª×™×—×ª ×¡× ×™×£</span>
                    </div>
                    <div style="min-height: 200px;">
                        <p>×©×œ×•× ×¨×‘,</p>
                        <p>×”×¨×™× ×• ×œ×—×“×“ ××ª ×”× ×”×œ×™× ×‘× ×•×’×¢ ×œ×©×¢×•×ª ×”×¤×ª×™×—×” ×•×”×¡×’×™×¨×” ×©×œ ×”×¡× ×™×¤×™× ×”×—×œ ××”×—×•×“×© ×”×§×¨×•×‘.</p>
                        <ul>
                            <li>×¤×ª×™×—×ª ×¡× ×™×£: 09:00 ×‘×“×™×•×§.</li>
                            <li>×“×•×— ×¡×’×™×¨×ª ×§×•×¤×” ×—×•×‘×” ×œ×©×œ×•×— ×¢×“ 22:30.</li>
                        </ul>
                        <p>×‘×‘×¨×›×”,<br>×”×”× ×”×œ×”</p>
                    </div>
                </div>
            `,

            // Ø§Ù„Ù‚Ø§Ù„Ø¨ 6: Ø´Ù‡Ø§Ø¯Ø©
            certificate: `
                <div style="border: 5px double var(--theme-color); padding: 40px; height: 100%; text-align: center; box-sizing: border-box;">
                    <div style="font-family: 'Playfair Display'; font-size: 40px; font-weight: bold; color: var(--theme-color); margin-bottom: 20px;">Certificate of Excellence</div>
                    <div style="font-size: 20px; text-transform: uppercase; letter-spacing: 2px; margin-bottom: 40px;">×ª×¢×•×“×ª ×”×¢×¨×›×” ×•×”×¦×˜×™×™× ×•×ª</div>
                    
                    <p>××•×¢× ×§×ª ×‘×–××ª ×œ- / This is presented to</p>
                    <h1 style="font-size: 36px; margin: 20px 0; border-bottom: 1px solid #ccc; display: inline-block; padding: 0 20px;">×©× ×”×¢×•×‘×“ / ×”×¡× ×™×£</h1>
                    
                    <p style="margin-top: 30px; line-height: 1.6;">
                        ×¢×œ ×ª×¨×•××” ×™×•×¦××ª ×“×•×¤×Ÿ, ××¡×™×¨×•×ª ×•××§×¦×•×¢×™×•×ª<br>
                        ×©×”×•×‘×™×œ×• ×œ×”×™×©×’×™× ××¨×©×™××™× ×¢×‘×•×¨ ×¨×©×ª MAD PARFUMEUR.
                    </p>
                    
                    <div style="margin-top: 60px; display: flex; justify-content: space-around;">
                        <div>________________<br>×× ×›"×œ</div>
                        <div>07/01/2026<br>×ª××¨×™×š</div>
                    </div>
                </div>
            `,

            // Ø§Ù„Ù‚Ø§Ù„Ø¨ 7: Ù†Ù…ÙˆØ°Ø¬ Ø§Ø³ØªÙ„Ø§Ù…
            delivery: `
                <h2 style="text-align: center; background: #eee; padding: 10px;">×˜×•×¤×¡ ××¡×™×¨×” / ×§×‘×œ×ª ×¦×™×•×“ (Delivery Note)</h2>
                <div class="info-grid" style="margin-top: 20px;">
                    <div><strong>× ××¡×¨ ×œ:</strong> ________________</div>
                    <div><strong>× ××¡×¨ ×¢"×™:</strong> ××—×¡×Ÿ ×¨××©×™</div>
                    <div><strong>×™×¢×“:</strong> ×¡× ×™×£ ×—×“×¨×”</div>
                    <div><strong>×ª××¨×™×š:</strong> 07/01/2026</div>
                </div>
                <table class="mad-table">
                    <thead><tr><th>××§"×˜</th><th>×ª×™××•×¨ ×¤×¨×™×˜</th><th>×›××•×ª ×©× ×©×œ×—×”</th><th>×›××•×ª ×©×”×ª×§×‘×œ×”</th><th>×”×¢×¨×•×ª</th></tr></thead>
                    <tbody>
                        <tr><td>___________</td><td>__________________________</td><td>_____</td><td>_____</td><td>___________</td></tr>
                        <tr><td>___________</td><td>__________________________</td><td>_____</td><td>_____</td><td>___________</td></tr>
                        <tr><td>___________</td><td>__________________________</td><td>_____</td><td>_____</td><td>___________</td></tr>
                        <tr><td>___________</td><td>__________________________</td><td>_____</td><td>_____</td><td>___________</td></tr>
                    </tbody>
                </table>
                <div style="margin-top: 30px;">
                    <p><strong>××™×©×•×¨ ××§×‘×œ ×”×¡×—×•×¨×”:</strong></p>
                    <p>×× ×™ ×××©×¨ ×›×™ ×§×™×‘×œ×ª×™ ××ª ×”×¡×—×•×¨×” ×”× "×œ ×‘××¦×‘ ×ª×§×™×Ÿ.</p>
                    <br>
                    <div style="display:flex; gap: 20px;">
                        <span>×©× ××œ×: ____________</span>
                        <span>×—×ª×™××”: ____________</span>
                    </div>
                </div>
            `
        };

        // --- 2. Ø¯ÙˆØ§Ù„ Ø§Ù„ØªØ­ÙƒÙ… ---
        
        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ù„Ø¨
        function loadTemplate(type) {
            document.getElementById('mainContent').innerHTML = templates[type];
        }

        // ØªØºÙŠÙŠØ± Ø§Ù„Ø£Ù„ÙˆØ§Ù†
        function setTheme(color, showFrame) {
            document.documentElement.style.setProperty('--theme-color', color);
        }

        function toggleFrame(val) {
            const page = document.getElementById('page');
            if(val === 'yes') page.classList.add('show-frame');
            else page.classList.remove('show-frame');
        }

        // ØªØºÙŠÙŠØ± Ø§Ù„Ø­Ø¬Ù… ÙˆØ§Ù„Ø´ÙØ§ÙÙŠØ©
        function resizeEl(id, val, prop) {
            const el = document.getElementById(id);
            if(prop === 'width') el.style.width = val + 'px';
            if(prop === 'opacity') el.style.opacity = val;
        }

        // Ø±ÙØ¹ Ø§Ù„ØµÙˆØ±
        function loadImage(input, id, showStamp = false) {
            if(input.files && input.files[0]) {
                const img = document.getElementById(id);
                img.src = URL.createObjectURL(input.files[0]);
                img.style.display = 'block';
                if(showStamp) document.getElementById('stamp-wrapper').style.display = 'block';
            }
        }

        // --- 3. Ù…Ù†Ø·Ù‚ Ø§Ù„Ø³Ø­Ø¨ (Drag & Drop) ---
        let isDragging = false, startX, startY, initLeft, initTop;
        const stampWrap = document.getElementById('stamp-wrapper');

        function startDrag(e) {
            e.preventDefault();
            isDragging = true;
            startX = e.clientX; startY = e.clientY;
            initLeft = stampWrap.offsetLeft; initTop = stampWrap.offsetTop;
            stampWrap.style.cursor = 'grabbing';
            document.addEventListener('mousemove', doDrag);
            document.addEventListener('mouseup', stopDrag);
        }

        function doDrag(e) {
            if(!isDragging) return;
            stampWrap.style.left = (initLeft + e.clientX - startX) + 'px';
            stampWrap.style.top = (initTop + e.clientY - startY) + 'px';
        }

        function stopDrag() {
            isDragging = false;
            stampWrap.style.cursor = 'grab';
            document.removeEventListener('mousemove', doDrag);
            document.removeEventListener('mouseup', stopDrag);
        }

        // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù‚Ø§Ù„Ø¨ Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠ Ø¹Ù†Ø¯ Ø§Ù„Ø¨Ø¯Ø¡
        loadTemplate('letter');

    </script>
</body>
</html>
